# Dockerfile.runtime
FROM node:20-alpine AS runtime
WORKDIR /app

# Copy package manifests first for better layer caching
COPY package*.json ./

ENV NODE_ENV=production
RUN npm ci --only=production --no-audit --prefer-offline --no-fund

# Copy the built artifacts from the repo (built by workflow)
COPY dist ./dist
# If you need public/static assets, uncomment and copy them
# COPY public ./public

EXPOSE 3000
CMD ["node", "dist/server.js"]
